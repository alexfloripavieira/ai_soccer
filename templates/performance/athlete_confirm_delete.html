{% extends 'base.html' %}

{% block title %}Excluir Atleta • AI Soccer{% endblock %}

{% block content %}
{# Modal Overlay #}
<div id="deleteModal"
     class="fixed inset-0 z-50 overflow-y-auto"
     aria-labelledby="modal-title"
     role="dialog"
     aria-modal="true">

  {# Background Overlay with blur #}
  <div class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm transition-opacity duration-300 ease-out"
       id="modalBackdrop"></div>

  {# Modal Container #}
  <div class="flex min-h-screen items-center justify-center p-4">

    {# Modal Content #}
    <div id="modalContent"
         class="relative w-full max-w-2xl transform overflow-hidden rounded-2xl border border-red-500/40 bg-gradient-to-br from-slate-800 to-slate-900 shadow-2xl shadow-red-500/20 transition-all duration-300 ease-out"
         style="opacity: 0; transform: scale(0.95);">

      {# Header #}
      <div class="border-b border-red-500/30 bg-red-500/10 px-6 py-6 sm:px-8">
        <div class="flex items-start">
          {# Warning Icon #}
          <div class="flex-shrink-0">
            <div class="flex h-12 w-12 items-center justify-center rounded-full bg-red-600 shadow-lg shadow-red-500/50">
              <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
              </svg>
            </div>
          </div>

          {# Title and Badge #}
          <div class="ml-4 flex-1">
            <span class="inline-flex items-center gap-2 rounded-full border border-red-500/40 bg-red-500/20 px-3 py-1 text-xs font-semibold uppercase tracking-widest text-red-200">
              Atenção
            </span>
            <h2 id="modal-title" class="mt-3 text-2xl font-bold text-slate-100 sm:text-3xl">
              Deseja realmente excluir este atleta?
            </h2>
            <p class="mt-2 text-sm text-slate-300 sm:text-base">
              Esta ação é permanente e removerá todos os dados do atleta
              <strong class="text-red-300">{{ object.name }}</strong> do sistema.
            </p>
          </div>

          {# Close Button #}
          <button type="button"
                  id="modalCloseBtn"
                  class="ml-4 flex-shrink-0 rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-700 hover:text-slate-200 focus:outline-none focus:ring-2 focus:ring-red-500">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>

      {# Body #}
      <div class="px-6 py-6 sm:px-8">

        {# Details Grid #}
        <dl class="grid grid-cols-1 gap-4 rounded-xl border border-red-500/30 bg-slate-950/60 p-6 sm:grid-cols-2">
          <div>
            <dt class="text-xs font-semibold uppercase tracking-widest text-slate-500">Nome</dt>
            <dd class="mt-1 text-base font-semibold text-slate-100 sm:text-lg">{{ object.name }}</dd>
          </div>
          <div>
            <dt class="text-xs font-semibold uppercase tracking-widest text-slate-500">Posição</dt>
            <dd class="mt-1 text-base font-semibold text-slate-100 sm:text-lg">
              {{ object.get_position_display|default:'Não informado' }}
            </dd>
          </div>
          <div>
            <dt class="text-xs font-semibold uppercase tracking-widest text-slate-500">Nacionalidade</dt>
            <dd class="mt-1 text-base font-semibold text-slate-100 sm:text-lg">
              {{ object.nationality|default:'Não informado' }}
            </dd>
          </div>
          <div>
            <dt class="text-xs font-semibold uppercase tracking-widest text-slate-500">Criado em</dt>
            <dd class="mt-1 text-base font-semibold text-slate-100 sm:text-lg">
              {{ object.created_at|date:'d/m/Y H:i' }}
            </dd>
          </div>
        </dl>

        {# Form #}
        <form method="post" class="mt-8">
          {% csrf_token %}

          {# Action Buttons #}
          <div class="flex flex-col-reverse gap-3 sm:flex-row sm:justify-end">
            {# Cancel Button #}
            <a href="{% url 'performance:athlete_detail' object.pk %}"
               class="inline-flex items-center justify-center rounded-lg border border-slate-700 bg-slate-800 px-6 py-3 text-sm font-semibold text-slate-200 transition-all duration-200 hover:border-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-500">
              Cancelar
            </a>

            {# Delete Button #}
            <button type="submit"
                    class="inline-flex items-center justify-center rounded-lg bg-red-600 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-red-500/30 transition-all duration-200 hover:bg-red-500 hover:shadow-red-400/40 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2 focus:ring-offset-slate-900">
              <svg class="mr-2 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
              Confirmar exclusão
            </button>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  (function() {
    'use strict';

    const modal = document.getElementById('deleteModal');
    const modalContent = document.getElementById('modalContent');
    const modalBackdrop = document.getElementById('modalBackdrop');
    const closeBtn = document.getElementById('modalCloseBtn');

    // Open modal with animation
    function openModal() {
      document.body.style.overflow = 'hidden'; // Prevent body scroll

      // Trigger animation after a small delay to ensure CSS transition works
      requestAnimationFrame(() => {
        modalBackdrop.style.opacity = '1';
        modalContent.style.opacity = '1';
        modalContent.style.transform = 'scale(1)';
      });
    }

    // Close modal with animation
    function closeModal() {
      modalBackdrop.style.opacity = '0';
      modalContent.style.opacity = '0';
      modalContent.style.transform = 'scale(0.95)';

      setTimeout(() => {
        window.location.href = '{% url "performance:athlete_detail" object.pk %}';
      }, 300); // Match transition duration
    }

    // Open modal on page load
    openModal();

    // Close on backdrop click
    modalBackdrop.addEventListener('click', closeModal);

    // Close on close button click
    closeBtn.addEventListener('click', closeModal);

    // Close on ESC key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    // Prevent closing when clicking inside modal content
    modalContent.addEventListener('click', function(e) {
      e.stopPropagation();
    });

  })();
</script>
{% endblock %}
